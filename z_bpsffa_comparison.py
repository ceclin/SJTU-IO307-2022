import matplotlib.pyplot as plt
import pandas as pd
import seaborn as sns

import bpsffa
import bpsffa2

lams = pd.read_csv('lam_1.csv').to_numpy().reshape((-1))

si = [1.08, 1.63, 1.36, 1.09, 1.11, 1.23, 7.16, 8.21, 7.61, 4.21, 1.36, 1.1, 1.01, 6.94, 9.68, 8.77, 6.27, 5.99, 8.88,
      10.89, 6.49, 1.69, 1.96, 4.91, 3.43, 1.31, 1.2, 1.11, 0.97, 2.01, 8.56, 9.41, 7.53, 4.09, 2.03, 1.16, 1.01, 11.45,
      12.13, 9.5, 10.54, 10.42, 8.45, 9.9, 8.77, 5.88, 5.53, 4.82, 2.85, 1.55, 1.1, 0.93, 1.13, 1.17, 7.31, 7.7, 6.19,
      2.82, 1.97, 1.29, 1.02, 7.06, 8.98, 9.34, 11.59, 10.1, 10.84, 12.71, 9.95, 5.6, 3.18, 2.64, 2.2, 1.7, 1.27, 1.11,
      1.08, 1.62, 6.44, 8.07, 6.12, 3.16, 2.22, 1.57, 1.05, 5.09, 10.22, 9.47, 9.43, 9.89, 8.24, 7.96, 9.77, 11.68,
      9.66, 4.23, 7.45, 9.49, 8.97, 7.94, 7.16, 8.41, 13.05, 11.06, 9.73, 5.07, 1.32, 1.46, 1.03, 8.74, 10.42, 8.41,
      3.71, 3.72, 7.02, 11.0, 8.97, 5.66, 7.92, 10.66, 8.69, 4.87, 2.42, 1.81, 1.47, 1.79, 8.15, 9.1, 6.82, 2.75, 1.9,
      1.43, 1.1, 10.71, 10.16, 6.24, 5.62, 5.25, 9.38, 10.59, 7.3, 4.5, 9.08, 13.14, 11.03, 4.95, 2.65, 1.32, 1.13,
      1.56, 10.71, 10.43, 6.46, 1.19, 1.09, 1.01, 1.01, 13.63, 12.33, 9.93, 11.34, 10.89, 9.12, 8.12, 4.51, 2.62, 5.84,
      7.16]

si_ta = [
    0.764182, 1.63608, 0.877782, 0.56577, 0.688777, 1.15177, 9.07722, 12.0407, 8.24406, 4.32584, 3.18566, 2.48041,
    2.35924, 9.53065, 10.5164, 7.90185, 6.80649, 6.21672, 11.3687, 11.1114, 5.26892, 3.00032, 2.38308, 5.31114, 0.89066,
    0.580283, 0.932039, 0.382753, 0.816644, 2.11888, 10.2642, 11.2984, 6.10473, 4.99408, 2.90427, 2.53878, 1.53915,
    12.8995, 9.74012, 8.53147, 10.2514, 8.7674, 9.79489, 11.1022, 10.0445, 5.45748, 6.26116, 3.88666, 1.0634, 0.650364,
    0.386311, 0.313966, 1.20572, 0.885106, 9.81413, 10.1523, 6.83376, 2.72227, 3.93526, 1.99725, 1.99468, 8.60871,
    8.90417, 9.81047, 11.8373, 9.19692, 11.5484, 11.6903, 6.93996, 4.39506, 1.79795, 2.10723, 1.33951, 0.863665,
    0.566348, 0.699757, 0.676303, 1.40569, 8.16263, 9.90699, 5.19378, 3.67935, 3.59987, 3.09304, 1.7509, 5.70823,
    11.1364, 9.7524, 8.9268, 9.48711, 7.59058, 9.20728, 11.0098, 12.0302, 5.71361, 1.99263, 6.82163, 6.90483, 6.07734,
    4.82149, 5.56937, 6.55519, 12.7102, 11.8404, 9.80579, 2.85776, 2.98839, 3.30776, 2.05213, 10.0636, 11.0489, 4.31592,
    3.99092, 4.32291, 8.73155, 12.5691, 8.05931, 6.15602, 7.93289, 10.6415, 1.11734, 1.13575, 0.677537, 1.32156,
    0.670045, 1.94288, 9.70101, 11.0058, 6.26237, 3.07284, 3.96493, 2.34907, 2.16824, 12.3844, 10.2016, 5.23408,
    6.59561, 5.71617, 11.3007, 9.73556, 5.68113, 3.50368, 9.89847, 13.0336, 0.849881, 1.00871, 0.503879, 0.568544,
    0.518635, 1.50866, 12.4626, 12.3403, 2.32888, 3.12491, 2.71744, 1.92717, 2.48121, 14.2567, 9.9745, 8.99324, 10.9272,
    9.46721, 7.69523, 6.87221, 3.86497, 1.96817, 5.44955, 5.85616,
]

cs = [2, 2, 2, 2, 2, 2, 2, 7, 7, 7, 7, 7, 7, 2, 3, 3, 3, 3, 5, 6, 7, 5, 2, 1, 2, 2, 2, 2, 2, 2, 2, 6, 6, 6, 6, 6, 6, 1,
      3, 3, 3, 3, 5, 5, 6, 5, 2, 2, 2, 2, 2, 2, 2, 2, 2, 6, 6, 6, 6, 6, 6, 1, 2, 3, 3, 5, 5, 5, 5, 4, 3, 2, 2, 2, 2, 2,
      2, 2, 2, 6, 6, 6, 6, 6, 6, 1, 1, 3, 3, 3, 3, 4, 5, 4, 4, 4, 1, 1, 1, 1, 1, 1, 1, 6, 6, 6, 6, 6, 6, 2, 4, 4, 4, 4,
      4, 5, 6, 4, 2, 1, 2, 2, 2, 2, 2, 2, 2, 6, 6, 6, 6, 6, 6, 1, 4, 4, 4, 4, 4, 4, 5, 4, 1, 1, 2, 2, 2, 2, 2, 2, 2, 7,
      7, 7, 7, 7, 7, 1, 4, 4, 4, 5, 5, 5, 6, 4, 1, 1]

b1 = [0]
for i, c in enumerate(cs):
    b1.append(bpsffa.get_next_system_length(5.9113, lams[i], c, b1[i]))

b2 = [0]
for i, c in enumerate(cs):
    b2.append(bpsffa2.get_next_system_length(5.9113, lams[i], c, b2[i]))

df = pd.DataFrame({'si': si_ta, 'b1': b1[1:], 'b2': b2[1:]})

plt.figure(figsize=(20, 5))
sns.lineplot(df[['si', 'b1']], markers=True)
plt.show()
plt.figure(figsize=(20, 5))
sns.lineplot(df[['si', 'b2']], markers=True)
plt.show()
